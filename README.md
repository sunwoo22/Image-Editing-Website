# Image-Editing-Website-using-JSP
### JSP ê¸°ë°˜ì˜ ì´ë¯¸ì§€ í¸ì§‘ ë° ì €ì¥ ì›¹ì‚¬ì´íŠ¸   
ì…ë‹ˆë‹¤.   
<br>
<hr>

## ğŸ”¥ í”„ë¡œì íŠ¸ ê°œìš”
JSPë¥¼ í†µí•´ ì›¹ ë¸Œë¼ìš°ì €ì™€ ì„œë²„, DBë¥¼ ì—°ê²°í•œ ë™ì  ì›¹í˜ì´ì§€ì— ëŒ€í•´ ê³µë¶€í–ˆë‹¤.
ì•ì„œ ë°°ìš´ ì´ë¯¸ì§€ ë””ì§€í„¸ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ í¸ì§‘, ì €ì¥í•  ìˆ˜ ìˆëŠ” ì›¹ì‚¬ì´íŠ¸ë¥¼ ë§Œë“¤ê³ ì í–ˆë‹¤.      
<br>
   
## ğŸ›  í”„ë¡œì íŠ¸ í™˜ê²½
âœ… **ì‚¬ìš© ì–¸ì–´**: JSP / HTML5 / CSS3 / JAVASCRIPT   
âœ… **ê°œë°œ í™˜ê²½**: Eclipse / Visual Studio Code   
âœ… **ì œì‘ ê¸°ê°„**: 21.03.25 â€“ 21.03.30   
âœ… **JSP í™˜ê²½ ì„¤ì •**: JDK 9.0.4 / Eclipse Java EE (Oxygen 2) / apache-tomcat-9.0.2   
âœ… **ë°ì´í„°ë² ì´ìŠ¤**: MariaDB 10.5.9   
<br>
   
## ğŸ’» í™”ë©´ êµ¬ì„±
ğŸ’¨ **main.jsp**: ë¡œê·¸ì¸ ì „ ë©”ì¸ í™”ë©´   
<br>
<img src="https://user-images.githubusercontent.com/84164109/119072215-17750280-ba26-11eb-9c9e-2bbdd6096982.png">
<br><br>
ğŸ’¨ **join-client.jsp**: íšŒì›ê°€ì…   
<br>
<img src="https://user-images.githubusercontent.com/84164109/119072234-1d6ae380-ba26-11eb-8b0f-cbb546b27d4e.png">
<br><br>
ğŸ’¨ **login-client.jsp**: ë¡œê·¸ì¸   
<br>
<img src="https://user-images.githubusercontent.com/84164109/119072230-1c39b680-ba26-11eb-907e-6cbf03dcc9df.png">
<br><br>
ğŸ’¨ **main-login.jsp**: ë¡œê·¸ì¸ í›„ ë©”ì¸ í™”ë©´(ì´ë¯¸ì§€ ì„ íƒ)   
<br>
<img src="https://user-images.githubusercontent.com/84164109/119072289-307db380-ba26-11eb-8325-65ef0f2bc9c1.png">
<br><br>
ğŸ’¨ **photo-edit.jsp**: ì´ë¯¸ì§€ í¸ì§‘ ë° ì €ì¥   
<br>
<img src="https://user-images.githubusercontent.com/84164109/119072238-1e9c1080-ba26-11eb-92df-97f5d971deed.png">
<br><br>
ğŸ’¨ **mypage.jsp**: ë§ˆì´í˜ì´ì§€(ì €ì¥í•œ ì´ë¯¸ì§€ ë³´ê¸°)   
<br>
<img src="https://user-images.githubusercontent.com/84164109/119072260-278ce200-ba26-11eb-9bf7-4ac5e8a20d8b.png">
<br><br>
ğŸ’¨ **changepw-client.jsp**: ë¹„ë°€ë²ˆí˜¸ ë³€ê²½   
<br>
<img src="https://user-images.githubusercontent.com/84164109/119072259-265bb500-ba26-11eb-93bd-2f199c60f4b4.png">
<br><br>
ğŸ’¨ **withdrawal-client.jsp**: íšŒì›íƒˆí‡´   
<br>
<img src="https://user-images.githubusercontent.com/84164109/119072313-3a071b80-ba26-11eb-9fc5-2aa7ceb55bc6.png">
<br><br>

## ğŸ’¾ ì„œë²„ êµ¬ì„±
ğŸ’¨ **join-server.jsp**: íšŒì›ê°€ì…(ì•„ì´ë”” ì¤‘ë³µ í™•ì¸)   
ğŸ’¨ **join-server2.jsp**: íšŒì›ê°€ì…   
ğŸ’¨ **login-server.jsp**: ë¡œê·¸ì¸   
ğŸ’¨ **changepw-server.jsp**: ë¹„ë°€ë²ˆí˜¸ ë³€ê²½   
ğŸ’¨ **withdrawal-server.jsp**: íšŒì›íƒˆí‡´   
ğŸ’¨ **photo-save.jsp**: ì´ë¯¸ì§€ ì €ì¥   
<br>
   
## ğŸ¬ ì‹œì—° ì˜ìƒ
> https://youtu.be/DfDwhXcBNZY
<br>
<img src="https://user-images.githubusercontent.com/84164109/119073053-87d05380-ba27-11eb-9ff4-7c86ccabc28f.PNG">
<br>

## ğŸ’¦ ë³´ì™„í•  ì 
ì„¸ì…˜ ì‚¬ìš©ë²•ì„ ì˜ ëª°ë¼ì„œ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í–ˆë‹¤...   
ê·¸ë˜ì„œ ë©”ì¸í˜ì´ì§€ê°€ ë‘ê°œê°€ ë˜ì–´ë²„ë ¸ë‹¤.   
íšŒì›ê°€ì…ì‹œ ì •ë³´ ì¶”ê°€   
ë§ˆì´í˜ì´ì§€ ì´ë¯¸ì§€ ê°€ë” ì˜¤ë¥˜ë‚˜ëŠ” ê²ƒ ìˆ˜ì •   
(eclipse refresh ì˜¤ë¥˜ì¸ ë“¯)   
<br>
   
## ğŸº ì¼ê¸°ì¥
> https://mygummy2.tistory.com/45
<br>
   
## ğŸ’ ì¤‘ìš” ì½”ë“œ
âœ” **Maria DB ì‚¬ìš© ë° í…Œì´ë¸” ìƒì„±**
```
C:\> mysql -u root -p
Enter pawwsord: 1234

MariaDB [(none)]> create project_db;
MariaDB [(none)]> use project_db;

MariaDB [project_db]> create table user(
                     user_id char(8) primary key,
                     user_pw char(8) not null,
                     image_num int(2) default 0
                     );
```
âœ” **íšŒì›ê°€ì…ì‹œ DBì— ì •ë³´**
```JSP
<!-- DBì™€ ì—°ê²° -->
<%@ include file="dbconnect.jsp"%>

<%
	// clientì—ì„œ ë°›ì•„ì˜¨ id, pw
   String user_id = request.getParameter("user_id");
	String user_pw = request.getParameter("user_pw");
	String user_pw_ck = request.getParameter("user_pw_ck");

	// ë¬¸ìì—´ ì •ê·œì‹ ê²€ì‚¬
	Pattern p = Pattern.compile("(^[a-zA-Z0-9]*$)");
	Matcher m_id = p.matcher(user_id);
	Matcher m_pw = p.matcher(user_pw);

   // sql ì¿¼ë¦¬ë¬¸ ì „ì†¡ì„ ìœ„í•œ statement ê°ì²´ ìƒì„±
	ResultSet rs = null;
	Statement stmt = conn.createStatement();

   // sql ì¿¼ë¦¬ë¬¸: ì•„ì´ë”” ì¤‘ë³µ ì²´í¬
	String sql = "SELECT user_id FROM user ";
	sql += "WHERE user_id = '" + user_id + "';";

   // ì¿¼ë¦¬ë¬¸ ì‹¤í–‰
	rs = stmt.executeQuery(sql);
	
   // íšŒì›ê°€ì… ì‹¤íŒ¨ì‹œ ê²½ê³ ì°½ ìƒì„±
	if(user_id == "") {
		%><script> alert("ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); history.go(-1); </script><%
	} else if(!m_id.find()) {
		%><script> alert("ì•„ì´ë””ëŠ” ì˜ì–´, ìˆ«ìë§Œ ì…ë ¥ê°€ëŠ¥í•©ë‹ˆë‹¤."); history.go(-1); </script><%			
	} else if(user_pw == "") {
		%><script> alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); history.go(-1); </script><%
	} else if(user_pw_ck == "") {
		%><script> alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”."); history.go(-1); </script><%
	} else if(!user_pw.equals(user_pw_ck)) {
		%><script> alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”."); history.go(-1); </script><%
	} else if(!m_pw.find()) {
		%><script> alert("ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ì–´, ìˆ«ìë§Œ ì…ë ¥ê°€ëŠ¥í•©ë‹ˆë‹¤."); history.go(-1); </script><%			
	} else if(user_id.equals(user_pw)) {
		%><script> alert("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ê°€ ê°™ìŠµë‹ˆë‹¤."); history.go(-1); </script><%	
	} else if(rs.next()) {
		%><script> alert("ì•„ì´ë”” ì¤‘ë³µ í™•ì¸ì„ í•´ì£¼ì„¸ìš”."); history.go(-1); </script><%
	} 
   
   // íšŒì›ê°€ì… ì„±ê³µ
   else {
      // sql ì¿¼ë¦¬ë¬¸: DBì— ê°€ì… ì •ë³´ ì „ë‹¬
		sql = "INSERT INTO user VALUES (";
		sql += "'" + user_id + "', '" + user_pw + "', 0";
		sql += ");";

		stmt.executeUpdate(sql);
		
      // ì„¸ì…˜ì— ì•„ì´ë”” ë° ì´ë¯¸ì§€ ê°œìˆ˜(0) ì €ì¥
		session.setAttribute("user_id", user_id);
		session.setAttribute("image_num", 0);
		
      // default ì´ë¯¸ì§€ ì €ì¥
		String defalutFname = "default.png";
		
      // (1) íŒŒì¼ ì²˜ë¦¬
		File inFp;
		FileInputStream inFs;
		inFp = new File("C:/eclipse-workspace/jsp_project/WebContent/upload/" + defalutFname);
		
		BufferedImage cImage = ImageIO.read(inFp);
		int inW = cImage.getHeight();
		int inH = cImage.getWidth();
      
		// (2) ë°°ì—´ ì²˜ë¦¬
		int[][][] inImage = new int[3][inH][inW]; // ë©”ëª¨ë¦¬ í• ë‹¹
		// íŒŒì¼ --> ë©”ëª¨ë¦¬
		for (int i=0; i<inH; i++) 
			for (int k=0; k<inW; k++) {
				int rgb = cImage.getRGB(i,k);
				inImage[0][i][k] = (rgb >> 16) & 0xFF; // Red
				inImage[1][i][k] = (rgb >> 8) & 0xFF; // Green
				inImage[2][i][k] = (rgb ) & 0xFF; // Blue
			}
		
      // (3) ì•Œê³ ë¦¬ì¦˜ ì ìš©
		int[][][] outImage = new int[3][inH][inW];
		for(int j=0; j<3; j++) 
			for (int i=0; i<inH; i++) 
				for (int k=0; k<inW; k++) 
					outImage[j][i][k] = inImage[j][i][k];
		
		// (4) íŒŒì¼ ì €ì¥
		File outFp;
		FileOutputStream outFs;
		String joinFname = user_id + "_out.png";
		outFp = new File("C:/eclipse-workspace/jsp_project/WebContent/upload/" + joinFname);
		
		BufferedImage outCImage = new BufferedImage(inH, inW, BufferedImage.TYPE_INT_RGB);
		
		outFs = new FileOutputStream(outFp.getPath());
      
		// ë©”ëª¨ë¦¬ --> ë²„í¼ì´ë¯¸ì§€
		for (int i=0; i<inH; i++) 
			for (int k=0; k<inW; k++) {
				int r = outImage[0][i][k];
				int g = outImage[1][i][k];
				int b = outImage[2][i][k];
				int px = 0;
				px = px | (r << 16);
				px = px | (g << 8);
				px = px | (b);		
				outCImage.setRGB(i,k,px);
			}
		
		ImageIO.write(outCImage, "png", outFp);
		
		%><script> alert("ê°€ì…ë˜ì—ˆìŠµë‹ˆë‹¤.");
		window.location.href = 'login-client.jsp'; // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
		</script><%
	}

	stmt.close();
	conn.close();
	
%>
```
âœ” **ë§ˆì´í˜ì´ì§€ì— ì €ì¥í•œ ì´ë¯¸ì§€ ì¶œë ¥**
```java script
<script>
	function img_info(value) {
		// ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ìˆë˜ ì‚¬ìš©ì user_id ë°›ì•„ì˜´
	    var user_id = sessionStorage.getItem("user_id");
		//var user_id = "aaaa";
		
		// ì„¸ì…˜ì— ìˆë˜ ì‚¬ìš©ì image_num ë°›ì•„ì˜´(ì €ì¥í•  ë•Œë§ˆë‹¤ +1: ì‚¬ìš©ìê°€ ì €ì¥í•œ ì´ë¯¸ì§€ ì´ ê°œìˆ˜)
		 var image_num = <%=session.getAttribute("image_num")%>;
	    //var max = 2;
	    
	    // ì´ë¯¸ì§€ ê²½ë¡œë¥¼ ë„£ì„ ë¬¸ìì—´ ìƒì„±
	    var img_src = "";

	    // ì¶œë ¥ë  ì‚¬ìš©ì ì´ë¯¸ì§€ number = ì‚¬ìš©ì image_num - ì´ë¯¸ì§€ ìˆœì„œvalue
        var num = image_num - value;
        if(num > 0) // ì‚¬ìš©ìê°€ ì €ì¥í•œ ì´ë¯¸ì§€ ì¶œë ¥
            img_src = 'upload/'+ user_id + '_out (' + num + ').png';
        else // ì´ ì¶œë ¥ ì´ë¯¸ì§€ ê°œìˆ˜ì¸ 8ê°œë³´ë‹¤ ì‚¬ìš©ìê°€ ì €ì¥í•œ ì´ë¯¸ì§€ ê°œìˆ˜ê°€ ì ì„ ê²½ìš° default.png ì¶œë ¥
            img_src = 'upload/default.png';

        // ì´ë¯¸ì§€ ê²½ë¡œ ë°˜í™˜
		return img_src;
	}

</script>
```
```html
<div class='img'>
   <img id='img0' class='img-in' src=''>
   <script>document.getElementById('img0').src=img_info(0)</script>
</div>

```

